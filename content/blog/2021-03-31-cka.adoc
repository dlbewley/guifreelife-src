---
:course_publisher: Udemy
course_title: Certified Kubernetes Administrator (CKA) with Practice Tests
:course_url: https://www.udemy.com/course/certified-kubernetes-administrator-with-practice-tests/
:date: Fri Nov 13 10:32:58 PST 2020
:icons: font
:sectanchors:
:toc:
:toc: []
---
== {course_title}

{course_url}[{course_title}] v1.19

* https://kodekloud.slack.com
* https://github.com/mmumshad/kubernetes-the-hard-way

.**Certification Info**
[TIP]
====
https://www.cncf.io/certification/cka/[CKA Cert]

* http://training.linuxfoundation.org/go//Important-Tips-CKA-CKAD

**Study tips**

* https://github.com/kodekloudhub/certified-kubernetes-administrator-course
* https://suraj.io/post/road-to-cka/
* https://github.com/walidshaari/Kubernetes-Certified-Administrator
* https://github.com/kelseyhightower/kubernetes-the-hard-way

**Allowed acces to the following kubernetes documentation**

* https://github.com/kubernetes/
* https://kubernetes.io/blog/
* https://kubernetes.io/docs/
* https://kubernetes.io/docs/reference/kubectl/cheatsheet/
====

== Section 1 - Overview

* https://www.cncf.io/certification/cka/[CKA] $300 w/ 1 free retake

.**Reference Notes**
[TIP]
We have created a repository with notes, links to documentation and answers to practice questions here. Please make sure to go through these as you progress through the course:
https://github.com/kodekloudhub/certified-kubernetes-administrator-course

= Section 2 - Core Concepts

* Local PDF link:Kubernetes+-CKA-+0100+-+Core+Concepts.pdf[]
* Course access https://github.com/kodekloudhub/certified-kubernetes-administrator-course/tree/master/docs/02-Core-Concepts[Section 2]

== Architecture

== Etcd

.Install
* `wget -q --https-only \ https://github.com/coreos/etcd/releases/download/v3.3.9/etcd-v3.3.9-linux-amd64.tar.gz`
* Non-kubeadm install uses `/etc/systemd/system/etcd.service`

.**OpenShift**
[TIP]
Etcd runs as clusteroperator `etcd`

.What is it?
* Stores all info for cluster
* On TCP port 2379

.Some etcdctl Commands
* V2 `etcdctl backup,cluster-health,mk,mkdir,set`
* V3 `etcdctl snapshot save,endpoint health,get,put`
* Use v3 by `export ETCDCTL_API=3`
* Cert flags:
[source,]
--cacert /etc/kubernetes/pki/etcd/ca.crt     
--cert /etc/kubernetes/pki/etcd/server.crt     
--key /etc/kubernetes/pki/etcd/server.key

.Example Startup
[source,bash]
----
kubectl exec etcd-master -n kube-system -- sh -c \
    "ETCDCTL_API=3 etcdctl get / \
    --prefix -keys-only \
    --limit=10 \
    --cacert /etc/kubernetes/pki/etcd/ca.crt \
    --cert /etc/kubernetes/pki/etcd/server.crt  \
    --key /etc/kubernetes/pki/etcd/server.key" 

# get all entries
etcdctl get / --prefix -keys-only
----

== Kube API Server

.Install
* `wget https://storage.googleapis.com/kubernetes-release/release/v1.13.0/bin/linux/amd64/kube-apiserver`
* Kubeadm install places pod manifest `/etc/kubernetes/manifests/kube-apiserver.yaml`
* Non-kubeadm install uses `/etc/systemd/system/kube-apiserver.service`

.What is it?
* Auth and validates requests serializes to and reads from etcd
* `ps -aux |grep kube-apiserver`

.A request to API server to create a pod
1 authn user
1 validate request
1 retrieve data
1 update etcd
1 scheduler
1 kubelet


== Kube Controller Manager

.Install
* `wget https://storage.googleapis.com/kubernetes-release/release/v1.13.0/bin/linux/amd64/kube-controller-manager`
* Kubeadm seetup places pod manifest `/etc/kubernetes/manifests/kube-controller-manager.yaml`
* Non-kubeadm install uses `/etc/systemd/system/kube-controller-manager.service`

.What is it?
* A process tht continualy monitors the state of systems and brings them to compliance
* `ps -aux |grep kube-controller-manager`


.Kube Controller Manager Oversees controllers passed as `--controllers` such as:
* cronjob
* deployment-confgoller
* job-controller
* namespace-controller
* `node-controller`
** checks nodes very 5s, unreachable after 40s, evict pods after 300s
* pv-bind-controller
* `replication-controller`
** ensure proper number of pods are running
* replicaset
* service-account-controller
* statefulset

"Full" list of controllers attachdetach, bootstrapsigner, clusterrole-aggregation, cronjob, csrapproving, csrcleaner, csrsigning, daemonset, deployment, disruption, endpoint, garbagecollector, horizontalpodautoscaling, job, namespace, nodeipam, nodelifecycle, persistentvolume-binder, persistentvolume-expander, podgc, pv-protection, pvc-protection, replicaset, replicationcontroller, resourcequota, root-ca-cert-publisher, route, service, serviceaccount, serviceaccount-token, statefulset, tokencleaner, ttl, ttl-after-finished

== Kube Scheduler

.Install
* `wget https://storage.googleapis.com/kubernetes-release/release/v1.13.0/bin/linux/amd64/kube-scheduler`
* Kubeadm install places pod manifest in `/etc/kubernetes/manifests/kube-scheduler.yaml`
* Non-kubeadm install uses `/etc/systemd/system/kube-scheduler.service`

.What is it?
* Decides where to place pods, but kubelete creates the pods

.Scheduling
* Filter Nodes with inadequate resources
* Rank Nodes 0 to 10.
** How many resources would remain if pod were placed on this node?


== Kubelet

.Install
* `wget https://storage.googleapis.com/kubernetes-release/release/v1.13.0/bin/linux/amd64/kubelet`
* Non kubeadm install uses /etc/systemd/system/kubelet.service
* Kubeadm install does not deploy the kubelete

.Kubelet deployment is manual
[IMPORTANT]
* Kubeadm install does not deploy the kubelete

.What is it?
* registers nodes
* creates pods
* monitor node and pods

== Kube-Proxy

.Install
* `wget https://storage.googleapis.com/kubernetes-release/release/v1.13.0/bin/linux/amd64/kube-proxy`
* Deployed as `daemonset kube-proy -n kube-system`

.What is it?
* kube-proxy runs on each node and watches for new services. creates rules on each node to forward requests to backend pods. one wasy is using iptables

== Pods

.What is it?
* Smallest schedulable resource
* Encapsulates 1 or more container

.Create with `kubectl run`
[source,bash]
kubectl run nginx --image nginx:latest
kubectl get pods -A
kubectl describe pod nginx

=== Create Pod with yaml

.Minimum required fields for a resource
[source,yaml]
----
apiVersion:
kind:
metadata:
spec:
----

.Full Pod definition
[source,yaml]
----
apiVersion: v1
kind: Pod
metadata:
  name: myapp-pod
  labels:
    app: myapp
    type: front-end
spec:
  containers:
    - name: nginx-container
      image: nginx:latest
----

== Practice Test

== Practice Labs

mailto:support@kodekloud.com[]

.See lecture 2.24 and create an account on KodeKloud
* Link: https://kodekloud.com/purchase?product_id=2021256&coupon_code=UDEMYSTUDENT151112
* If coupon is not applied automatically use the code `UDEMYSTUDENT151112`

=== Core Concepts

==== Pods

* "Create pod" means eg: `kubectl run nginx --image=nginx` or

[source,yaml]
apiVersion: v1
kind: Pod
metadata:
  name: nginx
spec:
  containers:
    - name: nginx
      image: nginx

==== ReplicaSets

* ReplicaSets are not in v1 they are in `apps/v1` ie: `kubectl explain replicaset|grep VERSION`

==== Deployments

* Deployments are not in v1 they are in `apps/v1` ie: `kubectl explain deployment|grep VERSION`

`kubectl create deploy webapp --image=kodekloud/webapp-color --replicas=3`

==== Namespaces

* Service dns names across namespaces look like `foo.foospace.svc.cluster.local`

==== Services

* Types like NodePort ClusterIP LoadBalancer
* Targetport is the port the container is running on
* Create services with expose command
`kubectl expose pod redis --port=6379 --name redis-service`
* Create pod and ClusterIP service
`kubectl run httpd --image=httpd:alpine --port=80 --expose`

==== Imperative Commands

= Section 3 - Scheduling
